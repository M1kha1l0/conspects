---
tags:
  - bd
---
# Два типа БД
## SQL
*Плюсы*:
	- Целостность данных.
	- Широкая поддержка.
	- Хорошо вертикально масштабируется.
	- Скорость работы.
*Минусы*:
	- Плохо горизонтально масштабируется.
	- Сложна в освоении.

## NoSQL
*Плюсы*:
	- Удобство работы.
	- Удобство обслуживания.
	- Хорошо горизонтально масштабируется.
*Минусы*:
	- Плохо с вертикальным масштабированием.
	- Скорость работы.

# Типы данных

1. **Boolen** - true/false.
2. **Integer** - целое число.
3. **Float** - дробное число.
4. **DateTime** - дата и время.
5. **Select** - список значений для выбора значения.
6. **Text** - строка.
7. **TextArea** - массив строк.
8. **WYSIWYG** - (what you see is what you get) визуальный редактор (как ворд какой-нибудь).
9. **Различные файловые данные** - медиа, текстовые файлы, архивы, массив файлов.
10. **Flexible** - (конструктор, повторитель) массив форм ввода.
11. **Jsonb** - поле JSON. Минитаблица внутри поля.

# Типы связей
## 1 к 1

Крайне редко используется.  Для жесткой связи между двумя таблицами.

## 1 ко многим

Когда есть одна таблица и от нее зависимы все остальные. Например, заказ и пользователь. Пользователь один, а заказов у него много.

В этой связи важно понимать кто "родитель", а кто "ребенок". Здесь все достаточно очевидно: кого много - ребенок, а кто один - родитель.
## Многие ко многим:

Когда есть множественные связи между таблицами. Например, теги и статьи. У одной статьи несколько тегов и у тегов есть несколько статей.

# Связи

Для каждой таблицы нужен свой столбец-идентификатор для работы с данными. Для такого столбца используют маркер ***primary*** (первичный ключ).

Связи между таблицами реализованы по столбцам-ключам. Для них используется маркер ***foregin*** (вторичный ключ).

Ключи используются только для ограничений (т.е. для сохранения целостности данных). Например, если удаляется одна строка-родитель, то за ней подтягиваются изменения в строках-детей.

Пример построения таблицы:
## 1 к многим
users:

| id (primary) | name | ... |
| ------------ | ---- | --- |
| 1            |      |     |
orders:

| id (primary) | user_id (foreign) | title |
| ------------ | ----------------- | ----- |
|              |                   |       |
На примере видим, что таблица  ***orders*** связана с ***users*** по столбцу *user_id*

## Многие ко многим
articles:

| id (primary) | title | ... |
| ------------ | ----- | --- |
|              |       |     |
tags:

| id (primary) | title | ... |
| ------------ | ----- | --- |
|              |       |     |
article_tags:

| article_id (foreign) | tag_id (foreign) | article_tag (primary) | ... |
| -------------------- | ---------------- | --------------------- | --- |
|                      |                  |                       |     |
В примере показана таблица ***article_tags***, у нее 2 зависимых столбца для сортировки статей по тегам. Причем каждой комбинации присваивается уникальный id для исключения повторений и ошибок в работе с данными.

# Метод OnDelete

Используется для удаления элемента БД. Существует ряд ограничений при удалении родителя:
- **Cascade** - удаляет всех детей (т.е. зависимые строки).
- **Set null** - записать null в колонку ребенка.
- **Restrict** - запретить удаление родителя.
- **Set default** - установить дефолтное значение в столбце-ребенка.